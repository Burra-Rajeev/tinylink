{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///D:/New%20project/tinylink/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\ndeclare global {\r\n    // allow global prisma in dev to avoid creating multiple instances\r\n    var prisma: PrismaClient | undefined;\r\n}\r\n\r\nconst prisma = global.prisma || new PrismaClient();\r\n\r\nif (process.env.NODE_ENV !== \"production\") global.prisma = prisma;\r\n\r\nexport default prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAOA,MAAM,SAAS,OAAO,MAAM,IAAI,IAAI,6IAAY;AAEhD,wCAA2C,OAAO,MAAM,GAAG;uCAE5C"}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///D:/New%20project/tinylink/pages/%5Bcode%5D.tsx"],"sourcesContent":["import { GetServerSideProps } from \"next\";\r\nimport prisma from \"../lib/prisma\";\r\n\r\nexport default function RedirectPage() {\r\n    return null; // nothing to show, just redirecting\r\n}\r\n\r\nexport const getServerSideProps: GetServerSideProps = async (context) => {\r\n    const code = (context.params?.code || \"\").toString();\r\n\r\n    const link = await prisma.link.findUnique({\r\n        where: { code },\r\n    });\r\n\r\n    if (!link) {\r\n        return {\r\n            notFound: true,\r\n        };\r\n    }\r\n\r\n    // Update click count + last clicked timestamp\r\n    await prisma.link.update({\r\n        where: { code },\r\n        data: {\r\n            clicks: { increment: 1 },\r\n            lastClicked: new Date(),\r\n        },\r\n    });\r\n\r\n    return {\r\n        redirect: {\r\n            destination: link.url,\r\n            permanent: false, // ensures 302 redirect\r\n        },\r\n    };\r\n};\r\n"],"names":[],"mappings":";;;;;;AACA;;AAEe,SAAS;IACpB,OAAO,MAAM,oCAAoC;AACrD;AAEO,MAAM,qBAAyC,OAAO;IACzD,MAAM,OAAO,CAAC,QAAQ,MAAM,EAAE,QAAQ,EAAE,EAAE,QAAQ;IAElD,MAAM,OAAO,MAAM,iHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QACtC,OAAO;YAAE;QAAK;IAClB;IAEA,IAAI,CAAC,MAAM;QACP,OAAO;YACH,UAAU;QACd;IACJ;IAEA,8CAA8C;IAC9C,MAAM,iHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACrB,OAAO;YAAE;QAAK;QACd,MAAM;YACF,QAAQ;gBAAE,WAAW;YAAE;YACvB,aAAa,IAAI;QACrB;IACJ;IAEA,OAAO;QACH,UAAU;YACN,aAAa,KAAK,GAAG;YACrB,WAAW;QACf;IACJ;AACJ"}}]
}